#! /bin/tcsh

foreach p ( `cat /home/people/morni/netMHCpan-3.0/data/MHC_pseudo.dat | xC | args 2 | sort -u ` )

if ( ! -e $p.thr ) then

touch $p.thr

if ( -e ../$p.pred ) then

cat ../$p.pred | xC | gawk '$4 == "PEPLIST"' | args 3,5 | gawk '{printf( "%s %f\n", $1,$2)}' | sort -nrk2 > $$.sort

else 

echo "Error." $p "does not exist"

exit

endif

echo $p `wc $$.sort | args 1`

foreach f ( 0.01 0.015 0.02 0.025 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1 0.125 0.15 0.175 0.2 0.25 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0 1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9 2 2.5 3 3.5 4 4.5 5 5.5 6 6.5 7 7.5 8 8.5 9 9.5 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 55 60 65 70 75 80 85 90 95)

set N = `echo $f | gawk '{print ($1*200000)/100}' `

set line = `cat $$.sort | head -$N | tail -1`

echo $f $line >> $p.thr

end

rm -f $$.sort

endif

end
